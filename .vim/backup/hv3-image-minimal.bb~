SUMMARY = "HV3 base image"

#inherit extrausers
#EXTRA_USERS_PARAMS = "usermod -p $(openssl passwd safran2022) root;"


SAFRAN-SECURITY-APPLICATION-HIDS = "samhain"
SAFRAN-SECURITY-APPLICATION-HIDS-SAMHAIN-CONF = "samhain-conf-hv3"
#PROJECT_APPLICATION += "linux-hardening"

PROJECT_APPLICATION += "curl"

# rootfs size correction
# Want to add "systemd-remount-fs.service". So need to remove the REMOVE_SYSTEMD present in safran-image-minimal.bb
REMOVE_SYSTEMD_remove = "systemd-remount-fs.service"

# Web
PROJECT_APPLICATION += "nspawncontainer-web"
PROJECT_APPLICATION += "util-linux-nsenter"
PROJECT_APPLICATION += "webstart"
PROJECT_APPLICATION += "rng-tools"

# Modes management
PROJECT_APPLICATION += "modes"

# Handle exFat format
PROJECT_APPLICATION += "fuse"
PROJECT_APPLICATION += "fuse-exfat"
PROJECT_APPLICATION += "exfat-utils"

# Lsblk cmd
PROJECT_APPLICATION += "util-linux-lsblk"

# network
PROJECT_APPLICATION += "systemd-network-conf-host"

# Init conffiles
PROJECT_APPLICATION += "initconf"

# GSM
PROJECT_APPLICATION += "libmbim"
PROJECT_APPLICATION += "gsm-network"
PROJECT_APPLICATION += "gsmsend"
PROJECT_APPLICATION += "ground-updates"
PROJECT_APPLICATION += "pbit"

# Update process
PROJECT_APPLICATION += "filefetcher"
PROJECT_APPLICATION += "rmc"
PROJECT_APPLICATION += "fls-dispatcher"
PROJECT_APPLICATION += "nor-installer"
PROJECT_APPLICATION += "hwcfg-install"
PROJECT_APPLICATION += "signaturemaker"
PROJECT_APPLICATION += "signaturemaker-hv3"
PROJECT_APPLICATION += "flash-tool"
#PROJECT_APPLICATION += "hmas-stub"

# WIFI
PROJECT_APPLICATION += "kernel-module-lwb5p-backports-laird"
PROJECT_APPLICATION += "lwb5plus-sdio-sa-m2-firmware"
PROJECT_APPLICATION += "wireless-regdb-static"
PROJECT_APPLICATION += "wifi-enable"
PROJECT_APPLICATION += "iw"

PROJECT_APPLICATION += "hwcfg-install"

# SAT
PROJECT_APPLICATION += "sat-control"

# eMMC management
PROJECT_APPLICATION += "mmc-utils"
PROJECT_APPLICATION += "boot-logger"
# Kernel modules
PROJECT_APPLICATION += "kernel-modules"

# Freeradius authent
PROJECT_APPLICATION += "freeradius"
PROJECT_APPLICATION += "freeradius-certs"

# Removed packages
PROJECT_APPLICATION_remove += "ubifs-mount-services"
PROJECT_APPLICATION_remove += "pt2pn"
PROJECT_APPLICATION_remove += "ptnor2ram"
PROJECT_APPLICATION_remove += "dataloader"
PROJECT_APPLICATION_remove += "dlagent"
PROJECT_APPLICATION_remove += "libsdl"
PROJECT_APPLICATION_remove += "cu-log-parser"
PROJECT_APPLICATION_remove += "uod-start"
PROJECT_APPLICATION_remove += "useruod"
PROJECT_APPLICATION_remove += "restricted-shell"
PROJECT_APPLICATION_remove += "cpu-extensions"
PROJECT_APPLICATION_remove += "mtd-utils mtd-utils-ubifs"
PROJECT_APPLICATION_remove += "dwnservices"
PROJECT_APPLICATION_remove += "libhmos-pn4as"
PROJECT_APPLICATION_remove += "useruod"

SAFRAN-SECURITY-APPLICATION-FIREWALL_remove  += "firewall-nftables-host"
SAFRAN-SECURITY-APPLICATION-FIREWALL += "firewall-hv3-nftables-host"

# Include LPHM image
require recipes-core/images/hm-image-minimal.bb

require include/hv3-common.inc
require include/hv3-secu.inc
