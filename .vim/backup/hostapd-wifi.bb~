LICENSE = "CLOSED"

inherit pkgconfig systemd

SYSTEMD_SERVICE_${PN} = "hostapd-wifi.service dhcprelay-wifi.service"
SYSTEMD_AUTO_ENABLE_${PN} = "enable"

SRC_URI = "file://wifi.hostapd.conf"
SRC_URI += "file://dhcprelay-wifi.service"
SRC_URI += "file://hostapd-wifi.service"

RDEPENDS_${PN} += "hostapd"
RDEPENDS_${PN} += "dhcprelay"

do_install() {
    install -d ${D}/${sysconfdir} ${D}${systemd_unitdir}/system/
    install -m 0644 ${WORKDIR}/wifi.hostapd.conf ${D}${sysconfdir}
    install -m 0644 ${WORKDIR}/hostapd-wifi.service ${D}${systemd_unitdir}/system/
    sed -i -e 's,@SBINDIR@,${sbindir},g' -e 's,@SYSCONFDIR@,${sysconfdir},g' ${D}${systemd_unitdir}/system/hostapd-wifi.service
    install -m 0644 ${WORKDIR}/dhcprelay-wifi.service ${D}${systemd_unitdir}/system/
}

FILES_${PN} += "  ${sysconfdir}/wifi.hostapd.conf \
                  ${systemd_unitdir}/system/dhcprelay-wifi.service \
                  ${systemd_unitdir}/system/hostapd-wifi.service \
"
