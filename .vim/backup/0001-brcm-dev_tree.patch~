--- git/arch/arm/boot/dts/am57xx-pcm-948-common.dtsi	2023-02-16 12:03:09.630366581 +0100
+++ git/arch/arm/boot/dts/am57xx-pcm-948-common_patched.dtsi	2023-02-16 12:33:37.750226104 +0100
@@ -32,6 +32,14 @@
 		regulator-boot-on;
 	};
 
+	vcc_3v3: fixedregulator-vcc_3v3 {
+		compatible = "regulator-fixed";
+		regulator-name = "vcc_3v3";
+		regulator-min-microvolt = <3300000>;
+		regulator-max-microvolt = <3300000>;
+		regulator-always-on;
+		regulator-boot-on;
+	};
 	hdmi0: connector@0 {
 		compatible = "hdmi-connector";
 		status = "okay";
@@ -309,7 +317,62 @@
 			DRA7XX_CORE_IOPAD(0x3790, PIN_INPUT_PULLDOWN | MUX_MODE15)
 		>;
 	};
+/*New part*/
+	mmc3_pins_sdr12: mmc3_pins_sdr12 {
+		pinctrl-single,pins = <
+			DRA7XX_CORE_IOPAD(0x377c, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AD4) mmc3_clk */
+			DRA7XX_CORE_IOPAD(0x3780, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC4) mmc3_cmd */
+			DRA7XX_CORE_IOPAD(0x3784, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC7) mmc3_dat0 */
+			DRA7XX_CORE_IOPAD(0x3788, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC6) mmc3_dat1 */
+			DRA7XX_CORE_IOPAD(0x378c, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC9) mmc3_dat2 */
+			DRA7XX_CORE_IOPAD(0x3790, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC3) mmc3_dat3 */
+		>;
+	};
+
+	mmc3_pins_hs: mmc3_pins_hs {
+		pinctrl-single,pins = <
+			DRA7XX_CORE_IOPAD(0x377c, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AD4) mmc3_clk */
+			DRA7XX_CORE_IOPAD(0x3780, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC4) mmc3_cmd */
+			DRA7XX_CORE_IOPAD(0x3784, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC7) mmc3_dat0 */
+			DRA7XX_CORE_IOPAD(0x3788, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC6) mmc3_dat1 */
+			DRA7XX_CORE_IOPAD(0x378c, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC9) mmc3_dat2 */
+			DRA7XX_CORE_IOPAD(0x3790, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC3) mmc3_dat3 */
+		>;
+	};
+
+	mmc3_pins_sdr25: mmc3_pins_sdr25 {
+		pinctrl-single,pins = <
+			DRA7XX_CORE_IOPAD(0x377c, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AD4) mmc3_clk */
+			DRA7XX_CORE_IOPAD(0x3780, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC4) mmc3_cmd */
+			DRA7XX_CORE_IOPAD(0x3784, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC7) mmc3_dat0 */
+			DRA7XX_CORE_IOPAD(0x3788, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC6) mmc3_dat1 */
+			DRA7XX_CORE_IOPAD(0x378c, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC9) mmc3_dat2 */
+			DRA7XX_CORE_IOPAD(0x3790, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC3) mmc3_dat3 */
+		>;
+	};
 
+	mmc3_pins_sdr50: mmc3_pins_sdr50 {
+		pinctrl-single,pins = <
+			DRA7XX_CORE_IOPAD(0x377c, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AD4) mmc3_clk */
+			DRA7XX_CORE_IOPAD(0x3780, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC4) mmc3_cmd */
+			DRA7XX_CORE_IOPAD(0x3784, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC7) mmc3_dat0 */
+			DRA7XX_CORE_IOPAD(0x3788, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC6) mmc3_dat1 */
+			DRA7XX_CORE_IOPAD(0x378c, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC9) mmc3_dat2 */
+			DRA7XX_CORE_IOPAD(0x3790, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC3) mmc3_dat3 */
+		>;
+	};
+
+	mmc3_pins_sdr104: mmc3_pins_sdr104 {
+		pinctrl-single,pins = <
+			DRA7XX_CORE_IOPAD(0x377c, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AD4) mmc3_clk */
+			DRA7XX_CORE_IOPAD(0x3780, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC4) mmc3_cmd */
+			DRA7XX_CORE_IOPAD(0x3784, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC7) mmc3_dat0 */
+			DRA7XX_CORE_IOPAD(0x3788, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC6) mmc3_dat1 */
+			DRA7XX_CORE_IOPAD(0x378c, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC9) mmc3_dat2 */
+			DRA7XX_CORE_IOPAD(0x3790, PIN_INPUT_PULLUP | MODE_SELECT | MUX_MODE0)	/* (AC3) mmc3_dat3 */
+		>;
+	};
+/**/
 	i2c3_pins_default: pinmux_i2c3_default {
 		pinctrl-single,pins = <
 			DRA7XX_CORE_IOPAD(0x3774, PIN_INPUT_PULLUP | MUX_MODE2)	/* (AC5) gpio6_10.i2c3_sda */
@@ -538,26 +601,48 @@
 };
 
 &mmc3 {
-        status = "disabled";
+        status = "okay";
 	pinctrl-names = "default", "sleep", "hs", "sdr12", "sdr25", "sdr50";
         pinctrl-0 = <&mmc3_pins_default &mmc3_iodelay_conf>;
         pinctrl-1 = <&mmc3_pins_sleep>;
-        pinctrl-2 = <&mmc3_pins_default &mmc3_iodelay_conf>;
-        pinctrl-3 = <&mmc3_pins_default &mmc3_iodelay_conf>;
-        pinctrl-4 = <&mmc3_pins_default &mmc3_iodelay_conf>;
-        pinctrl-5 = <&mmc3_pins_default &mmc3_iodelay_conf>;
+        pinctrl-2 = <&mmc3_pins_hs &mmc3_iodelay_conf>;
+        pinctrl-3 = <&mmc3_pins_sdr12 &mmc3_iodelay_conf>;
+        pinctrl-4 = <&mmc3_pins_sdr25 &mmc3_iodelay_conf>;
+        pinctrl-5 = <&mmc3_pins_sdr50 &mmc3_iodelay_conf>;
 	bus-width = <4>;
 
+vmmc-supply = <&ldo2_reg>;
+ vqmmc-supply = <&ldo2_reg>;
 	#address-cells = <1>;
 	#size-cells = <0>;
+        //enable-sdio-wakeup;
+        /*keep-power-in-suspend;*/
+  max-frequency = <50000000>;
+			/* SDR104/DDR50/SDR50 bits in CAPA2 is not supported */
+/*			sdhci-caps-mask = <0x0 0x400000>;*/
+			sd-uhs-sdr50;
 	wlcore: wlcore@0 {
-		status = "disabled";
+		status = "okay";
 
 		interrupt-parent = <&gpio1>;
 		interrupts = <25 IRQ_TYPE_EDGE_RISING>;
 	};
 };
-
+&mmc3 {
+#address-cells = <1>;
+	#size-cells = <0>;
+bus-width = <4>;
+	non-removable;
+ 
+	brcmf: wifi@1 {
+		reg = <1>;
+		status = "okay";
+		compatible = "brcm,bcm4329-fmac";
+    laird,regdomain = "EU";
+		interrupt-parent = <&gpio7>;
+		interrupts = <0 IRQ_TYPE_EDGE_RISING>;
+ 	};
+};
 &dss {
 	status = "okay";
 
