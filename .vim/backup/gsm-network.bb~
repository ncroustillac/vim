SUMMARY = "GSM network interface configuration"
DESCRIPTION = "A service to control the mbim network, and wwan0 if setting"
LICENSE = "CLOSED"

inherit systemd

FILESEXTRAPATHS_prepend := "${THISDIR}/files:"

SRC_URI += "file://gsm-network.sh"
SRC_URI += "file://gsm-network.service"
SRC_URI += "file://gsm-network.path"
SRC_URI += "file://mbim-network.conf"

SYSTEMD_SERVICE_${PN} = "gsm-network.service"
SYSTEMD_AUTO_ENABLE_${PN} = "enable"

RDEPENDS_${PN} = "hv3-gpio-ctrl"

do_install() {

  install -d ${D}${sysconfdir}/
  install -m 0755 ${WORKDIR}/mbim-network.conf ${D}${sysconfdir}/

  install -d ${D}/${systemd_unitdir}/system/
  install -m 0644 ${WORKDIR}/gsm-network.service ${D}/${systemd_unitdir}/system/
  install -m 0644 ${WORKDIR}/gsm-network.path ${D}/${systemd_unitdir}/system/

  install -d ${D}/usr/services/gsm-network
  install -m 0755 ${WORKDIR}/gsm-network.sh ${D}/usr/services/gsm-network
}

FILES_${PN} += "${systemd_unitdir}/system/"
FILES_${PN} += "/usr/services/gsm-network"
